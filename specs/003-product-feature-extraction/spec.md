## 1. 背景 Background

产品专员在对同类竞品进行分析时，通常会从外部系统（如 Sorftime 或内部 BI 系统）下载 Excel 表格数据。然而这些源数据中经常缺少关键产品特征字段，如：

产品类型

工作距离

电池类型

存储数据组

测量模式

……（类别不同，缺失字段不同）

目前这些字段需要人工逐条阅读每条产品的文本信息后手动提取，不但效率低下，也容易产生错误，无法满足快速竞争分析与产品规划需求。

因此，需要构建一个自动化系统，利用 LLM（DeepSeek）对源表格数据进行解析，自动抽取缺失的产品特征字段，提升整体分析效率。

## 2. 用户故事 User Story

作为一名产品专员，
当我从其他系统下载某一类别的产品 Excel（例如 20251112_25131713011_产品列表-奶瓶消毒剂.xlsx）时，
我希望系统能够自动解析表格中的所有字段，并让 AI 根据整条产品信息提取我所关注的特征字段，
以便我能够对同类产品进行多维度对比，从而指导产品开发方向与市场策略。

## 3. 系统目标流程（高层流程）
用户上传源数据
        ↓
系统自动识别所有字段并入库
        ↓
用户选择需要抽取的特征字段
        ↓
系统为每条产品生成抽取任务
        ↓
LLM（DeepSeek）解析整条产品信息并抽取字段
        ↓
抽取结果回写数据库（覆盖旧值）
        ↓
用户选择导出字段
        ↓
系统生成目标 Excel 文件

## 4. 核心功能说明
4.1 Excel 数据解析

自动识别所有列，字段不固定

多文件格式支持：.xlsx、.xls、.csv

可处理空字段

4.2 用户选择需抽取字段

用户可选择任意数量的目标抽取字段

选项可动态输入（无需预设）

4.3 LLM 抽取功能

输入：源表所有字段文本

模型：DeepSeek（不支持 fallback）

输出：指定字段的抽取结果（自由文本，无需单位统一或格式规范化）

4.4 任务系统

采用异步任务队列

每条产品对应一个独立抽取任务

展示任务状态（Pending / Processing / Success / Failed）

4.5 结果写入数据库

新抽取的数据将覆盖旧数据

不保留版本历史

支持重复抽取同一产品

4.6 导出功能

用户可自由选择需要导出的字段

可多次导出

字段顺序按照用户选择顺序排列

## 5. 系统范围（Scope）
在范围（In Scope）：

从上传的 Excel 中读取字段

识别并处理任意字段结构

使用 DeepSeek 从产品文本中抽取特征

将抽取结果回写数据库

基于用户选择导出 Excel

不在范围（Out of Scope）：

🔸 不抓取 Amazon 或其他外部网页内容

🔸 不规范化字段格式、单位

🔸 不进行品类映射、分类体系建立

🔸 不做多模型策略或 fallback

🔸 不提供历史版本管理

## 6. 需求边界说明（Clarified Requirements）
项目 说明
数据结构 字段不固定，系统需自动识别；空字段允许存在
LLM 输入 以 Excel 所有字段作为输入，由 AI 自动判断提取依据
抽取格式 不做规范化；不统一单位；不做枚举映射
处理方式 异步执行任务，可查看状态
模型策略 固定使用 DeepSeek；不做 fallback
任务管理 需要任务状态监控（成功/失败等）
导出配置 可自定义导出字段；顺序按用户选择；可多次导出
数据覆盖策略 新抽取结果覆盖旧数据；不保留版本记录
## 7. 系统流程图（文字版）
7.1 上传与解析阶段

用户上传 Excel

系统自动识别字段

数据入库（raw_data_table）

7.2 抽取任务阶段

用户选择抽取字段

系统按产品行生成任务

异步队列执行

调用 DeepSeek 解析整行数据

提取字段

写入 extracted_data_table

7.3 导出阶段

用户选择要导出的字段

系统合并 raw + extracted

导出 Excel

## 8. 数据更新策略

支持用户对同一产品重复抽取

每次抽取会覆盖旧数据

数据表中不保留历史版本

如需历史记录，可在未来增设“抽取日志表”

## 9. 后续可扩展方向（Future Scope）

增加字段标准化模块（如将 “100m”“100 m”“100M” 统一）

支持抽取模板（不同类目对应不同特征字段）

支持复杂字段（如多项测量模式列表）

支持数据可视化模块

支持外部数据抓取（下一阶段）
