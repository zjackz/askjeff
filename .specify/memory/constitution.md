# <!--
# Sync Report:
# - Version: 1.1.1 → 1.2.0 (新增原则，扩展交付约束)
# - Principles: 新增「容器优先与环境一致性」
# - Updated Templates: plan-template ✅, quickstart ✅
# - Deferred: 无
# -->

# AskJeff 宪章

## Core Principles（核心原则）

### I. 用户意图锚定
所有规格、计划、任务与清单必须复述最新用户诉求、明确范围与价值；无法证明与用户问题相关的工作一律拒绝。

### II. 独立价值切片
用户故事需纵向切分，可独立交付、测试与回滚；若存在跨故事依赖，必须提供书面理由与回退方案。

### III. 合约优先交付
接口、数据模型、CLI/HTTP 协议在编码前就要定义、评审并声明迁移影响；任何变更必须版本化并通知消费者。

### IV. 可验证证据优先
先写验收标准、量化指标与（如需要）自动化测试，确保先红后绿；性能、安全等非功能目标也需说明验证手段。

### V. 运维透明
交付物必须包含可观测性（日志、指标或操作步骤）、quickstart 以及变更说明，缺失需申请治理层豁免。

### VI. 全中文交付
代码、注释、Commit、文档及 UI/日志对外文案统一使用中文，可保留必要术语但需附中文解释；合入前必须完成本地化校对。

### VII. 容器优先与环境一致性
所有服务、测试与前端构建必须通过 Docker Compose 运行；默认使用 dev 环境（端口 8001/5174，数据库 `sorftime_dev`），测试环境仅在 `COMPOSE_ENV=test make up` 下启用（端口 8000/5173，数据库 `sorftime_test`）。禁止直接在宿主机运行后端/前端服务或跳过 Compose 覆盖的 env 配置。前端 E2E 依赖 Playwright 官方镜像，需在容器内执行。**默认所有 lint/测试/脚本命令均在对应 Compose 容器内执行，若需宿主机执行必须在文档中记录理由与批准人。**

## Delivery Artifacts（交付产物）

- `spec.md`：至少 3 个可独立上线的用户故事，引用原始需求并列出量化成功指标。
- `plan.md`：总结用户意图、宪章检查结果、接口/依赖/可观测性安排。
- `research.md`、`data-model.md`、`contracts/`：当合约或知识缺口存在时必须补齐，并在计划中引用。
- `tasks.md`：以用户故事为单位列出实现、验证、可观测性任务，指出阻塞项。
- `/speckit.checklist` 生成的清单需声明对应原则。
- 所有代码、注释、quickstart、runbook、导出文案等面向团队的文本必须为中文版本。
- 前端 E2E 报告：`frontend/playwright-report/` 需作为交付证据保留。

## Delivery Workflow（交付流程）

1. **发现**：采集需求与背景，执行 P1 校验。
2. **设计与合约**：输出规格/模型/合约，满足 P2、P3，并完成 Phase 0 评审。
3. **计划**：更新 plan.md，记录宪章 Gate、结构、可观测性、语言合规策略。
4. **实施**：按用户故事推进，先写测试/验收，落实日志与中文文案，完成独立验收。
5. **部署与审计**：执行 quickstart，验证仪表、语言合规与需求回溯，再宣布完成。

## Governance（治理）

- 本宪章优先于其他流程文档。
- 修订需附影响说明、版本升级理由、模板同步情况，并获项目负责人+1 审批。
- 版本号遵循 MAJOR.MINOR.PATCH，并在同步报告中记录。
- 至少每季度或严重事故后复盘宪章执行情况，并对违规项下发整改任务。
- 临时豁免仅生效一个发布周期，且要在受影响文件中注明责任人。
- 代码评审必须同时检查中文交付要求，重复违规需重新培训或拒绝合并。

**Version**: 1.2.0 | **Ratified**: 2025-11-15 | **Last Amended**: 2025-11-18
