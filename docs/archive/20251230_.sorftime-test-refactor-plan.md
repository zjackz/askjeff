# SorftimeTest.vue æ‹†åˆ†è®¡åˆ’

**æ–‡ä»¶**: `frontend/src/views/admin/SorftimeTest.vue`  
**å½“å‰å¤§å°**: 2779 è¡Œ  
**ç›®æ ‡å¤§å°**: ~300 è¡Œ  
**åˆ›å»ºæ—¶é—´**: 2025-12-18

---

## ğŸ“Š æ–‡ä»¶ç»“æ„åˆ†æ

```
SorftimeTest.vue (2779 è¡Œ)
â”œâ”€â”€ template (1-875 è¡Œ, 875 è¡Œ)
â”œâ”€â”€ script (876-1885 è¡Œ, 1010 è¡Œ)
â””â”€â”€ style (1886-2780 è¡Œ, 895 è¡Œ)
```

---

## ğŸ¯ æ‹†åˆ†æ–¹æ¡ˆ

### æ–°çš„ç›®å½•ç»“æ„

```
views/admin/sorftime-test/
â”œâ”€â”€ index.vue                    (~200 è¡Œ) - ä¸»å®¹å™¨
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ EndpointSelector.vue     (~150 è¡Œ) - API ç«¯ç‚¹é€‰æ‹©å™¨
â”‚   â”œâ”€â”€ RequestForm.vue          (~300 è¡Œ) - è¯·æ±‚å‚æ•°è¡¨å•
â”‚   â”œâ”€â”€ ResponseViewer.vue       (~250 è¡Œ) - å“åº”æŸ¥çœ‹å™¨
â”‚   â”œâ”€â”€ HistoryDrawer.vue        (~200 è¡Œ) - å†å²è®°å½•æŠ½å±‰
â”‚   â”œâ”€â”€ StatsDrawer.vue          (~150 è¡Œ) - ç»Ÿè®¡æŠ½å±‰
â”‚   â””â”€â”€ ShortcutsDialog.vue      (~100 è¡Œ) - å¿«æ·é”®å¯¹è¯æ¡†
â”œâ”€â”€ composables/
â”‚   â”œâ”€â”€ useApiRequest.ts         (~150 è¡Œ) - API è¯·æ±‚é€»è¾‘
â”‚   â”œâ”€â”€ useRequestHistory.ts     (~100 è¡Œ) - å†å²è®°å½•ç®¡ç†
â”‚   â”œâ”€â”€ useJsonHighlight.ts      (~80 è¡Œ)  - JSON é«˜äº®
â”‚   â””â”€â”€ useEndpointConfig.ts     (~200 è¡Œ) - ç«¯ç‚¹é…ç½®
â””â”€â”€ types/
    â””â”€â”€ sorftime.ts              (å·²å­˜åœ¨)
```

---

## ğŸ“‹ æ‹†åˆ†æ­¥éª¤

### é˜¶æ®µ 1: å‡†å¤‡å·¥ä½œ

1. âœ… åˆ›å»ºç›®å½•ç»“æ„

```bash
mkdir -p frontend/src/views/admin/sorftime-test/components
mkdir -p frontend/src/views/admin/sorftime-test/composables
mkdir -p frontend/src/views/admin/sorftime-test/types
```

2. âœ… å¤‡ä»½åŸæ–‡ä»¶

```bash
cp frontend/src/views/admin/SorftimeTest.vue frontend/src/views/admin/SorftimeTest.vue.backup
```

---

### é˜¶æ®µ 2: æå– Composables (ä¼˜å…ˆ)

#### 2.1 æå– useEndpointConfig.ts

**å†…å®¹**: æ‰€æœ‰ API ç«¯ç‚¹é…ç½®å’Œæ–‡æ¡£

**æå–çš„ä»£ç **:
- `apiDocs` å¯¹è±¡
- `endpointExamples` å¯¹è±¡
- `currentDoc` è®¡ç®—å±æ€§

**æ–‡ä»¶**: `composables/useEndpointConfig.ts`

---

#### 2.2 æå– useApiRequest.ts

**å†…å®¹**: API è¯·æ±‚é€»è¾‘

**æå–çš„ä»£ç **:
- `handleSend` å‡½æ•°
- `loading` çŠ¶æ€
- `response` çŠ¶æ€
- `error` çŠ¶æ€
- `responseStatus` çŠ¶æ€

**æ–‡ä»¶**: `composables/useApiRequest.ts`

---

#### 2.3 æå– useRequestHistory.ts

**å†…å®¹**: å†å²è®°å½•ç®¡ç†

**æå–çš„ä»£ç **:
- `requestHistory` æ•°ç»„
- `saveHistory` å‡½æ•°
- `loadHistory` å‡½æ•°
- `clearHistory` å‡½æ•°
- `deleteHistoryItem` å‡½æ•°
- `loadHistoryItem` å‡½æ•°

**æ–‡ä»¶**: `composables/useRequestHistory.ts`

---

#### 2.4 æå– useJsonHighlight.ts

**å†…å®¹**: JSON é«˜äº®æ˜¾ç¤º

**æå–çš„ä»£ç **:
- `highlightJson` å‡½æ•°
- `jsonViewOptions` çŠ¶æ€
- `filteredResponse` è®¡ç®—å±æ€§

**æ–‡ä»¶**: `composables/useJsonHighlight.ts`

---

### é˜¶æ®µ 3: æ‹†åˆ†ç»„ä»¶

#### 3.1 åˆ›å»º EndpointSelector.vue

**èŒè´£**: API ç«¯ç‚¹é€‰æ‹©å’Œå·¥å…·æ 

**Props**:

```typescript
interface Props {
  modelValue: string  // activeEndpoint
  loading: boolean
}
```

**Emits**:

```typescript
const emit = defineEmits<{
  'update:modelValue': [value: string]
  'load-example': []
  'show-history': []
  'show-shortcuts': []
  'show-stats': []
  'send-request': []
}>()
```

**æ¨¡æ¿å†…å®¹** (ä»åŸæ–‡ä»¶æå–):
- ç«¯ç‚¹é€‰æ‹©å™¨ (line 7-81)
- å·¥å…·æ æŒ‰é’® (line 83-105)
- å‘é€æŒ‰é’® (line 106-109)

---

#### 3.2 åˆ›å»º RequestForm.vue

**èŒè´£**: è¯·æ±‚å‚æ•°è¡¨å•

**Props**:

```typescript
interface Props {
  activeEndpoint: string
  form: Record<string, any>
  currentDoc: any
}
```

**Emits**:

```typescript
const emit = defineEmits<{
  'update:form': [value: Record<string, any>]
}>()
```

**æ¨¡æ¿å†…å®¹** (ä»åŸæ–‡ä»¶æå–):
- API ä¿¡æ¯éƒ¨åˆ† (line 114-124)
- å‚æ•°è¡¨å• (line 127-502)

---

#### 3.3 åˆ›å»º ResponseViewer.vue

**èŒè´£**: å“åº”å†…å®¹æŸ¥çœ‹

**Props**:

```typescript
interface Props {
  response: any
  loading: boolean
  error: any
  responseStatus: any
  businessStatus: any
}
```

**æ¨¡æ¿å†…å®¹** (ä»åŸæ–‡ä»¶æå–):
- å“åº”å¤´éƒ¨ (line 508-531)
- å“åº”å†…å®¹ (line 533-750)

---

#### 3.4 åˆ›å»º HistoryDrawer.vue

**èŒè´£**: å†å²è®°å½•æŠ½å±‰

**Props**:

```typescript
interface Props {
  visible: boolean
  history: Array<any>
}
```

**Emits**:

```typescript
const emit = defineEmits<{
  'update:visible': [value: boolean]
  'load-item': [item: any]
  'delete-item': [id: string]
  'clear-all': []
}>()
```

**æ¨¡æ¿å†…å®¹** (ä»åŸæ–‡ä»¶æå–):
- å†å²è®°å½•æŠ½å±‰ (line 753-810)

---

#### 3.5 åˆ›å»º StatsDrawer.vue

**èŒè´£**: è¯·æ±‚ç»Ÿè®¡æŠ½å±‰

**æ¨¡æ¿å†…å®¹** (ä»åŸæ–‡ä»¶æå–):
- ç»Ÿè®¡æŠ½å±‰ (line 813-850)

---

#### 3.6 åˆ›å»º ShortcutsDialog.vue

**èŒè´£**: å¿«æ·é”®å¸®åŠ©å¯¹è¯æ¡†

**æ¨¡æ¿å†…å®¹** (ä»åŸæ–‡ä»¶æå–):
- å¿«æ·é”®å¯¹è¯æ¡† (line 853-875)

---

### é˜¶æ®µ 4: åˆ›å»ºä¸»æ–‡ä»¶ index.vue

**å†…å®¹**:

```vue
<template>
  <div class="postman-container">
    <div class="main-content">
      <!-- Left Pane -->
      <div class="pane request-pane">
        <EndpointSelector
          v-model="activeEndpoint"
          :loading="loading"
          @load-example="loadExample"
          @show-history="historyDrawerVisible = true"
          @show-shortcuts="shortcutsDialogVisible = true"
          @show-stats="statsDrawerVisible = true"
          @send-request="handleSend"
        />
        
        <RequestForm
          :active-endpoint="activeEndpoint"
          v-model:form="form"
          :current-doc="currentDoc"
        />
      </div>
      
      <!-- Right Pane -->
      <div class="pane response-pane">
        <ResponseViewer
          :response="response"
          :loading="loading"
          :error="error"
          :response-status="responseStatus"
          :business-status="businessStatus"
        />
      </div>
    </div>
    
    <!-- Drawers & Dialogs -->
    <HistoryDrawer
      v-model:visible="historyDrawerVisible"
      :history="requestHistory"
      @load-item="loadHistoryItem"
      @delete-item="deleteHistoryItem"
      @clear-all="clearHistory"
    />
    
    <StatsDrawer v-model:visible="statsDrawerVisible" />
    
    <ShortcutsDialog v-model:visible="shortcutsDialogVisible" />
  </div>
</template>

<script setup lang="ts">
import { ref, computed } from 'vue'
import EndpointSelector from './components/EndpointSelector.vue'
import RequestForm from './components/RequestForm.vue'
import ResponseViewer from './components/ResponseViewer.vue'
import HistoryDrawer from './components/HistoryDrawer.vue'
import StatsDrawer from './components/StatsDrawer.vue'
import ShortcutsDialog from './components/ShortcutsDialog.vue'

import { useEndpointConfig } from './composables/useEndpointConfig'
import { useApiRequest } from './composables/useApiRequest'
import { useRequestHistory } from './composables/useRequestHistory'

// ä½¿ç”¨ composables
const { currentDoc, loadExample } = useEndpointConfig()
const { loading, response, error, responseStatus, businessStatus, handleSend } = useApiRequest()
const { requestHistory, loadHistoryItem, deleteHistoryItem, clearHistory } = useRequestHistory()

// çŠ¶æ€
const activeEndpoint = ref('product')
const form = ref({})
const historyDrawerVisible = ref(false)
const statsDrawerVisible = ref(false)
const shortcutsDialogVisible = ref(false)
</script>

<style scoped lang="scss">
// åªä¿ç•™å®¹å™¨æ ·å¼
.postman-container {
  // ...
}
</style>
```

---

## â±ï¸ é¢„è®¡æ—¶é—´

| é˜¶æ®µ | ä»»åŠ¡ | é¢„è®¡æ—¶é—´ |
|------|------|---------|
| 1 | å‡†å¤‡å·¥ä½œ | 10 åˆ†é’Ÿ |
| 2 | æå– Composables | 2 å°æ—¶ |
| 3 | æ‹†åˆ†ç»„ä»¶ | 4 å°æ—¶ |
| 4 | åˆ›å»ºä¸»æ–‡ä»¶ | 1 å°æ—¶ |
| 5 | æµ‹è¯•éªŒè¯ | 1 å°æ—¶ |
| **æ€»è®¡** | | **8 å°æ—¶** |

---

## âœ… éªŒè¯æ¸…å•

æ‹†åˆ†å®Œæˆåéœ€è¦éªŒè¯:

- [ ] æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] æ—  TypeScript é”™è¯¯
- [ ] æ—  ESLint é”™è¯¯
- [ ] æ‰€æœ‰ç»„ä»¶ â‰¤ 300 è¡Œ
- [ ] æ‰€æœ‰ composables â‰¤ 200 è¡Œ
- [ ] æ ·å¼æ­£å¸¸æ˜¾ç¤º
- [ ] å¿«æ·é”®æ­£å¸¸å·¥ä½œ
- [ ] å†å²è®°å½•æ­£å¸¸ä¿å­˜/åŠ è½½

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

- âœ… ä¸»æ–‡ä»¶ `index.vue` â‰¤ 300 è¡Œ
- âœ… æ‰€æœ‰å­ç»„ä»¶ â‰¤ 300 è¡Œ
- âœ… åŠŸèƒ½å®Œå…¨ä¸€è‡´
- âœ… ä»£ç å¯ç»´æŠ¤æ€§æå‡
- âœ… é€šè¿‡æ‰€æœ‰æµ‹è¯•

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **ä¿æŒåŠŸèƒ½ä¸€è‡´**: æ‹†åˆ†è¿‡ç¨‹ä¸­ä¸æ”¹å˜ä»»ä½•åŠŸèƒ½
2. **æ¸è¿›å¼æ‹†åˆ†**: ä¸€æ¬¡æ‹†åˆ†ä¸€ä¸ªç»„ä»¶,ç«‹å³æµ‹è¯•
3. **ä¿ç•™å¤‡ä»½**: åŸæ–‡ä»¶é‡å‘½åä¸º `.backup`
4. **æ›´æ–°è·¯ç”±**: æ›´æ–°è·¯ç”±é…ç½®æŒ‡å‘æ–°æ–‡ä»¶
5. **Git æäº¤**: æ¯å®Œæˆä¸€ä¸ªé˜¶æ®µå°±æäº¤

---

## ğŸš€ å¼€å§‹æ‰§è¡Œ

ç”±äºæ–‡ä»¶è¿‡å¤§,å»ºè®®åˆ†å¤šæ¬¡ä¼šè¯å®Œæˆ:

**æœ¬æ¬¡ä¼šè¯**: 
1. âœ… åˆ›å»ºç›®å½•ç»“æ„
2. âœ… æå– 1-2 ä¸ª composables
3. âœ… åˆ›å»º 1-2 ä¸ªç®€å•ç»„ä»¶

**åç»­ä¼šè¯**:
1. ç»§ç»­æ‹†åˆ†å‰©ä½™ç»„ä»¶
2. åˆ›å»ºä¸»æ–‡ä»¶
3. æµ‹è¯•éªŒè¯
4. åˆ é™¤å¤‡ä»½æ–‡ä»¶

---

**å‡†å¤‡å¥½å¼€å§‹æ‹†åˆ†äº†å—?** ğŸ¯
